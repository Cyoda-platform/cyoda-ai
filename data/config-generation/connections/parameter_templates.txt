= Parameter templates

When you add parameters to your endpoints, you associate the parameter with a template.

== Overview

Parameters are a list of objects. Each of them has the following:

- name
- default value (if required)
- is required
- type (path variable, request body variable, request param, header param, template variable)

There are 2 approaches to configuring parameters:

1. When a parameter value is taken from a request, it is set to a corresponding parameter as-is.
2. With an extra step in between: the parameter is associated with a template.

When you add parameters to your endpoints, you can enable the *Template* flag if you want to associate the parameter with a template. You can then fill in the **Template Value** field with a template string, which can comprise custom functions and parameters.

Template example:

```javascript
$cyoda_functions.base64($identifier)
$cyoda_functions.base64(${identifier})
```

A template can use other parameters which are used in the request, or intermediary parameters which are used only for template calculation and not propagated further to the data source request.

Such intermediary parameters belong to the *Template Variable* type:

In the example above, the value of path variable `$identifier` is calculated as the sum of `$param` and 100.

The order of parameters can be important. You need to ensure that a parameter's dependencies come before it. For example:
```java
$param
```
goes before
```java
$identifier
```
== Testing a parameter template

To test the functionality, click the *Test* button:

image::Screenshot-from-2022-06-09-18-51-40.png[]

In the window that opens, fill in the required parameter values and click the run icon:

The result will contain request parameter values, body, query and headers.


== Template engines

Template engines are used in the project implementation:

```java
 com.cyoda.plugins.datasource.service.handler.template.TemplateEngine
```

To configure a template engine, a component implementing `TemplateEngine` is needed.

The currently supported template engine is the https://velocity.apache.org/

The Velocity template engine supports a number of functions which can be extended by implementing the following:

```java
com.cyoda.plugins.datasource.service.handler.template.VelocityFunctions

```

Each component which implements `VelocityFunctions` provides a name, which will be used in Cobi to configure parameters.

=== List of current functions

(Provided as an example):

```javascript
$cyoda_functions.base64($param)
$cyoda_functions.md5Hex($param)
$cyoda_functions.md5HexUppercase($param)
$cyoda_functions.hash($param)
$cyoda_functions.concat($param1, $param2)
$cyoda_functions.add($param1, $param2)
```

=== Valid parameter names

Template variable parameter names support uppercase, hyphens, single, and multiple dollar signs. For any other special characters, you need to use an intermediary parameter.
